parameters:
  appId: ''
  appSecret: ''
  botName: ''
  botGroup: ''

steps:
  - task: AzureCLI@1
    displayName: 'Configure OAuth connection'
    inputs:
      azureSubscription: $(AzureSubscription)
      scriptLocation: inlineScript
      inlineScript: |
        call az bot show -g "${{ parameters.botGroup }}" -n "${{ parameters.botName }}"
        call az bot authsetting create -g "${{ parameters.botGroup }}" -n "${{ parameters.botName }}" -c TestOAuthProvider --client-id "${{ parameters.appId }}" --client-secret "${{ parameters.appSecret }}" --service "oauth2" --provider-scope-string '""' --parameters authorizationUrl=https://webjobs.botframework.com/api/testauthprovider/authorize tokenUrl=https://webjobs.botframework.com/api/testauthprovider/token refreshUrl=https://webjobs.botframework.com/api/testauthprovider/refresh clientId="${{ parameters.appId }}" clientSecret="${{ parameters.appSecret }}"
